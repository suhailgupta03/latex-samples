\documentclass[a4paper,12pt]{report}
\usepackage[english]{babel}
\usepackage{luacode}
\begin{luacode}
local socket = require("socket")
local json = require("json")
local file = io.open("sample-true.json")
local start = socket.gettime()
tab = json.parse(file:read("*all"))
texio.write_nl("Time passed parsing JSON: " .. socket.gettime() - start .. " s\string\n")
file:close()
\end{luacode}

\begin{luacode}
local function isempty(s)
  return s == nil or s == ''
end

function renderSections(tab)
	for i,k in ipairs(tab['tableOfContents']) do
		 local sec_start = socket.gettime()
		 tex.print ("\string\\chapter{" .. k.section.title .. "}")
		 tex.print("section text here")
		 for ii,kk in ipairs(k["subsection"]) do
		 	tex.print ("\string\\section{" .. kk.title .. "}")
		 	tex.print ("some text here")
			tex.print("\string\\newline")
			for iii, kkk in ipairs(kk["content"]) do
				if kkk['type'] == "text" then
					if not isempty(kkk["line"]) then
						tex.print(kkk["line"])
						tex.print("\string\\newline")
					end
				elseif kkk["type"] == "table" then
					local column_count = 0
					local row_count = 0
					col_schema = ""
					for _ in ipairs(kkk["columns"]) do 
						column_count = column_count + 1 
						col_schema = col_schema .. " |X"
					end
					col_schema = col_schema .. "|"
					for _ in ipairs(kkk["columns"][1]["values"]) do row_count = row_count + 1 end
					if not isempty(kkk.title) then
						tex.print("\string\\textbf{" .. kkk.title .."}")
						tex.print("\\\\[0.1in]")
					end
					tex.print("\string\\begin{tabularx}{\\linewidth}{"  .. col_schema ..  "}")
					tex.print("\\hline")
					for ci, c in ipairs(kkk["columns"]) do
						local c_name = string.gsub(c.name, "&","\\&")
						tex.print(c_name)
						if ci < column_count then
							tex.print(" & ")
						end
					end	
					tex.print("\\\\")
					tex.print("\\hline")
					i = 1
					while i <= row_count do
						local c_c = 1
						while c_c <= column_count do
							local row_val = kkk["columns"][c_c]["values"][i]
							row_val = string.gsub(row_val, "&", "\\&")
							tex.print(row_val)
							if c_c < column_count then
								tex.print(" & ")
							end
							c_c = c_c + 1
						end
						tex.print("\\\\")
						tex.print("\\hline")
						i = i + 1
					end
					tex.print("\string\\end{tabularx}")
					tex.print("\\\\[0.1in]")
				end
			end
		 end
		 texio.write_nl("Time passed rendering section: " .. socket.gettime() - sec_start .. " s\string\n")
	end
end
\end{luacode}

\title{\directlua{tex.print(tab['documentName'])}}
\author{\directlua{tex.print(tab['author'])}}
\usepackage{fancyhdr}
\usepackage{pgffor}
\usepackage{lastpage}
\usepackage{tabularx}
%\usepackage[extreme]{savetrees}
\usepackage[landscape, margin=1in]{geometry}
\usepackage[yyyymmdd,hhmmss]{datetime}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={MAC Report},
    bookmarks=true,
    pdfpagemode=FullScreen,
}
% https://en.wikibooks.org/wiki/LaTeX/Colors
\usepackage[svgnames]{xcolor}
\pagestyle{fancy}
\fancyhf{}


\lhead{\directlua{tex.print(tab['headerFooter']['header']['left'])}}
\rhead{\directlua{tex.print(tab['headerFooter']['header']['right'])}}
\lfoot{\directlua{tex.print(tab['headerFooter']['footer']['left'])}}
\rfoot{\thepage\ of \pageref{LastPage}}
\cfoot{}
\renewcommand*\contentsname{TABLE OF CONTENTS}


\begin{document}
\maketitle


\paragraph{Document Information}

\subparagraph{Document information is given in the table below}

\subparagraph{}
\begin{tabular}{|c| c| c|}
\hline
\textbf{S.No} & \textbf{Item} & \textbf{Information} \\
\hline
1 & Document ID & \directlua{tex.print(tab['documentId'])} \\
\hline
2 & Document Generated At & \directlua{tex.print(tab['documentGeneratedAt'])} \\
\hline	
3 & Document Generated By & \directlua{tex.print(tab['documentGeneratedBy'])} \\
\hline
4 & MAC Protocol ID & \directlua{tex.print(tab['macProtocolID'])} \\
\hline
\end{tabular}
%\newpage
%\textcolor{NavyBlue}{TABLE OF CONTENTS}
\tableofcontents
\directlua{renderSections(tab)}

\end{document}
